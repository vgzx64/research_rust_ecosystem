//! Vulnerability types handlers

use axum::{
    extract::State,
    http::StatusCode,
    response::Json,
};
use sea_orm::EntityTrait;

use crate::db::SharedState;
use crate::models::vulnerability_types;

pub async fn list(
    State(state): State<SharedState>,
) -> Result<Json<Vec<vulnerability_types::Model>>, StatusCode> {
    let types = vulnerability_types::Entity::find()
        .all(&state.db)
        .await
        .map_err(|_| StatusCode::INTERNAL_SERVER_ERROR)?;
    
    Ok(Json(types))
}
